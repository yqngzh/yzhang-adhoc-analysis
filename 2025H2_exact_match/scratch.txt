exact_match_student_v3_contextual_us: ${matching.default} {
     owners: ["#search-retrieval", "@yzhang"]
     description: "Semrel context filtering: context conditioned rule (US, based on nir_tm_so/si)"
     semrel_config {
         relevance_threshold: 0.0 //not used, set dynamically within the rule
         shop_score_threshold: 0.7
         tfserving:${semrel.tfserving.semrel-student-v3}
         ruleset: ["WebContextConditionedRule"]
     }
     dynamic_ir_config: ${core-matching.common.dynamic_ir_config} {
       blending_backend: seldon
       blending_modelset:  ${services.blender_seldon.search_blender_no_borda}
     }
     lexical_engine: ${matching.default.lexical_engine} {
       should_limit_solr_candidates: true
       enable_gqi: true
     }
     preretrieval: ${core-matching.common.preretrieval} {
        ann_feature_set: "nir-perso-lite"
     }
     ann: ${core-matching.common.ann} {
       candidate_source: ann
       config: {
         ann_ensemble: {
           seldon: ${services.ann_seldon.ann_ensemble_nir_plite_noxformer_loose_tm}
         }
       }
     }
     xwalk: ${core-matching.default.xwalk} {
       xwalk_candidate_source: disabled
     }
     xml: ${core-matching.common.xml} {
       request_config {
         k: 400,
         beam_size: 40,
         threshold: 0.0,
         pp: "sigmoid",
         multiterm_predict: "True"
       }
       xml_http_service: ${services.xml.xml_v2_multiterm_tm.http}
     }
     query_entity {
      query_entity: cached
        dataset: smu_query_entity_extraction_v2
        memcached {
          memcached_enabled: true
          ttl: 12 hours
      }
    }
  }

loc_exact_match_student_v3_contextual: ${matching.default} {
    owners: ["#search-retrieval", "@yzhang"]
    description: "Semrel context filtering: context conditioned rule (INTL, based on loc_nir_unify)"
    semrel_config {
        relevance_threshold: 0.0 //not used, set dynamically within the rule
        shop_score_threshold: 0.7
        tfserving:${semrel.tfserving.semrel-student-v3}
        ruleset: ["WebContextConditionedRule"]
    }
    dynamic_ir_config: ${core-matching.common.dynamic_ir_config} {
      blending_backend: seldon
      blending_modelset:  ${services.blender_seldon.search_blender_no_borda}
    }
    lexical_engine: ${matching.default.lexical_engine} {
      should_limit_solr_candidates: true
    }
    preretrieval: ${core-matching.common.preretrieval} {
      ann_feature_set: "nir-perso-lite"
    }
    ann: ${core-matching.common.ann} {
      candidate_source: ann
      config: {
        ann_ensemble: {
          seldon: ${services.ann_seldon.ann_ensemble_nir_plite_noxformer_loose_tm}
        }
      }
    }
    xwalk: ${core-matching.default.xwalk} {
      xwalk_candidate_source: disabled
    }
  }